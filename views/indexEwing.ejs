<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript">
    	function validar() {
    		console.log("Aca ando!");
    	}
    </script>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  </head>
  <body>
    <h1><%= title %></h1>
    <p>Ingrese una palabra para traudir del espa&ntilde;ol al ingl&eacute;s</p>

    <div class="row">
	    <form class="col s12">
	      <div class="row">
	        <div class="input-field col s12">
	          <i class="material-icons prefix">search</i>
	          <input id="palabra" type="text" class="validate">
	          <label for="palabra">Palabra</label>
	        </div>
	      </div>
	    </form>
  	</div>

    <div class="row hide" id="card-row">
      <div class="col s12 m6">
        <div class="card blue-grey darken-1">
          <div class="card-content white-text">
            <span class="card-title" id="card-palabra" style="padding-bottom: 20px">Palabra</span>
            <p id="card-traduccion">Traducci&oacute;n</p>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col s12 m6">
        <a class="waves-effect waves-light btn-large" id="btnTraducir"><i class="material-icons left">cloud</i>Traducir</a>
      </div>
    </div>

    <!--JavaScript at end of body for optimized loading-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  </body>

  <script type="text/javascript">
  	$(document).ready(function(){
  		console.log("Listo con el JQuery");
      $('#btnTraducir').on('click', function(event)  {
        console.log("Click on Validar!");
        console.log($('#palabra').val());
        var jqxhr = $.get( "/traducir", { palabra: $('#palabra').val() }, function() {
          console.log( "success" );
          $("#card-row").removeClass("hide");
          result = jqxhr.responseJSON;
          if ( result.wordStatus == "Found" ) {
            console.log( "Traducida:", result.translated );
            $("#card-palabra").html( $('#palabra').val() );
            $("#card-traduccion").html("");
            var i = 0;
            result.translated.forEach( (item) => {
              i++;
              console.log(item);
              $("#card-traduccion").html( $("#card-traduccion").html() + '<div class="row"><div class="col s12"><input name="t' + i + '" type="radio" checked /><span>' + item + '</span></div></div>' );
            })
          } else {
            $("#card-palabra").html( $('#palabra').val() );
            $("#card-traduccion").html( "Traducci&oacute;n no encontrada" );
          }
        })
        .fail(function() {
          result = jqxhr.responseJSON;
          console.log( "error:", result.resp );
        });
      });
  	});
  </script>

</html>
